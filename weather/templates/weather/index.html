{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Global Weather Network</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet">
    

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body style="background-image: url('{{ bg_image }}'); background-size: cover; background-position: center; background-repeat: no-repeat;">

<div class="overlay">
    <div class="container animated-fade">

        <h1 class="title">ğŸŒ¤ï¸ Global Weather Network</h1>

        <form method="get" class="search-form">
            <input type="text" name="city" placeholder="Search for a city..." 
                   value="{{ weather.city|default:'' }}">
            <button type="submit">Search</button>
        </form>

        {% if weather %}
        <div class="weather-card animated-slide">
            <h2 class="city">{{ weather.city }}</h2>
            <p class="local-time">ğŸ•’ {{ weather.local_time }}</p>
            <p class="temp" id="tempValue">{{ weather.temp }}Â°C</p>
            <button id="toggleTemp" class="toggle-btn">Switch to Â°F</button>
            <p class="description">{{ weather.description }}</p>
            <p class="details">
                ğŸ’§ Humidity: <strong>{{ weather.humidity }}</strong>  
                | ğŸŒ¬ï¸ Wind: <strong>{{ weather.wind }} m/s</strong>
            </p>
            <img class="weather-icon"
                 src="http://openweathermap.org/img/wn/{{ weather.icon }}@2x.png">
        </div>
        {% endif %}

        {% if error %}
        <p class="error">{{ error }}</p>
        {% endif %}

        {% if forecast %}
        <h3 class="section-title">ğŸ“… 5-Day Forecast</h3>
        <div class="forecast">
            {% for f in forecast %}
            <div class="forecast-card animated-zoom">
                <p class="forecast-day">{{ f.day }}</p>
                <img src="http://openweathermap.org/img/wn/{{ f.icon }}@2x.png">
                <p class="forecast-temp">{{ f.temp }}Â°C</p>
                <p class="forecast-desc">{{ f.description }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if weather %}
        <h3 class="section-title">ğŸ—ºï¸ City Map</h3>
        <iframe
            class="map"
            loading="lazy"
            allowfullscreen
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps?q={{ weather.lat }},{{ weather.lon }}&hl=en&z=12&output=embed">
        </iframe>
        {% endif %}

    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const tempElement = document.getElementById("tempValue");
    const toggleButton = document.getElementById("toggleTemp");
    if (!tempElement) return;

    let celsius = parseFloat(tempElement.innerText);
    let isCelsius = true;

    toggleButton.addEventListener("click", function () {
        if (isCelsius) {
            let fahrenheit = (celsius * 9 / 5) + 32;
            tempElement.innerText = fahrenheit.toFixed(1) + "Â°F";
            toggleButton.innerText = "Switch to Â°C";
        } else {
            tempElement.innerText = celsius + "Â°C";
            toggleButton.innerText = "Switch to Â°F";
        }
        isCelsius = !isCelsius;
    });
});
</script>

</body>
</html>
